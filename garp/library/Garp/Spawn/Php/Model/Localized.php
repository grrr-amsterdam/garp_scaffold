<?php
/**
 * Generated PHP model
 * @author David Spreekmeester | grrr.nl
 * @package Garp
 * @subpackage Spawn
 */
class Garp_Spawn_Php_Model_Localized extends Garp_Spawn_Php_Model_Abstract {
	const MODEL_DIR = '/modules/default/models/';

	/**
	 * @var String $_locale
	 */
	protected $_locale;


	/**
	 * @param	Garp_Spawn_Model_Base	$model		The base model this habtm model is connected to
	 * @param	String					$locale		F.i.: 'en' or 'nl'
	 */
	public function __construct(Garp_Spawn_Model_Base $model, $locale) {
		parent::__construct($model);
		
		$this->setLocale($locale);
	}

	public function isOverwriteEnabled() {
		return true;
	}

	public function getPath() {
		$model 	= $this->getModel();
		$locale = ucfirst($this->getLocale());
		return APPLICATION_PATH . self::MODEL_DIR . $model->id . $locale . '.php';
	}
		
	/**
	 * @return String
	 */
	public function getLocale() {
		return $this->_locale;
	}
	
	/**
	 * @param String $locale
	 */
	public function setLocale($locale) {
		$this->_locale = $locale;
	}

	public function render() {
		$model 			= $this->getModel();
		$locale			= $this->getLocale();
			
		$parentClass	= 'Model_' . $model->id;
		$class 			= $parentClass . ucfirst($locale);
		
		$view			= new Garp_Spawn_MySql_View_I18n($model, $locale);
		$viewName		= $view->getName();

		$out = 
			  $this->_rl("<?php")
			. $this->_rl('/* This file was generated by '. get_class() .' - do not edit */')
			. $this->_rl("class {$class} extends {$parentClass} {", 0)
			. $this->_rl("protected \$_name = '{$viewName}';", 1)
			. $this->_rl("}", 0, 0)
		;

		return $out;
	}
}